<div class="ui segment" data-segment="{{ formset.prefix }}-{% if not is_empty %}{{ forloop.counter0 }}{% else %}__prefix__{% endif %}-SEGMENT">
  {% for hidden in form.hidden_fields %}{{ hidden }}{% endfor %}
  {% if form.non_field_errors %}
  <div class="ui segment">
    {{ form.non_field_errors }}
  </div>
  {% endif %}
  <div class="ui labeled input">
    <div class="ui label">{{ form.title.label }}</div>
    {{ form.title }}
  </div>
  <div class="ui buttons">

    <a class="ui compact small icon floated button button-hover-red" data-tooltip="Supprimer ce fond cartographique"
      data-position="right center" data-variation="mini" data-delete-form="{{ formset.prefix }}-{% if not is_empty %}{{ forloop.counter0 }}{% else %}__prefix__{% endif %}-DELETE">
      <i class="ui grey trash alternate icon"></i>
      <div style="display: none">
        {{ form.DELETE }}
      </div>
    </a>
  </div>
  <div class="nested">
    {% if form.nested %}
    {{ form.nested.management_form }}
    <div class="ui segments" data-segments="{{ form.nested.prefix }}-SEGMENTS">
      {% for contextlayer_form in form.nested %}
      {% include 'geocontrib/project/project_mapping_contextlayer.html' with formset=form.nested form=contextlayer_form is_empty=False %}
      {% endfor %}
    </div>
    <div class="formset_hidden" data-empty-form="{{ form.nested.prefix }}-EMPTY" style="display: none">
      {% include 'geocontrib/project/project_mapping_contextlayer.html' with formset=form.nested form=form.nested.empty_form is_empty=True %}
    </div>

    <div class="ui buttons">
      <a class="ui compact small icon left floated button button-hover-green" data-tooltip="Ajouter une couche" data-position="right center" data-variation="mini" data-add-form="{{ form.nested.prefix }}-ADD">
        <i class="ui plus icon"></i>
      </a>
    </div>
    {% endif %}
  </div>
</div>
